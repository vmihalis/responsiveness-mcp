---
phase: 19-ascii-art-branding
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - src/cli/banner.ts
  - src/cli/commands.ts
  - src/cli/__tests__/banner.test.ts
autonomous: true

must_haves:
  truths:
    - "Running `screenie --version` displays ASCII art banner with SCREENIE text"
    - "Running `screenie -v` displays identical output to --version"
    - "Banner includes version number"
    - "Banner includes tagline"
    - "Banner fits within 80 character terminal width"
    - "All existing tests continue to pass"
  artifacts:
    - path: "src/cli/banner.ts"
      provides: "ASCII banner generation function"
      exports: ["generateBanner"]
      min_lines: 20
    - path: "src/cli/__tests__/banner.test.ts"
      provides: "Banner unit tests"
      contains: "describe('ASCII Banner'"
      min_lines: 30
  key_links:
    - from: "src/cli/commands.ts"
      to: "src/cli/banner.ts"
      via: "import generateBanner"
      pattern: "import.*generateBanner.*from.*banner"
    - from: "src/cli/commands.ts"
      to: "version output"
      via: "custom version action"
      pattern: "generateBanner\\(__PKG_VERSION__\\)"
---

<objective>
Add ASCII art branding to Screenie CLI that displays on version check.

Purpose: Establish professional CLI identity with stylish ASCII banner showing tool name, version, and tagline.

Output: Working --version and -v flags that display ASCII art banner instead of plain version number.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/19-ascii-art-branding/19-RESEARCH.md

# Existing files to modify/reference
@src/cli/commands.ts
@src/cli/errors.ts
@src/cli/__tests__/e2e.test.ts
@package.json
@tsup.config.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install figlet and create banner module</name>
  <files>
    package.json
    src/cli/banner.ts
  </files>
  <action>
1. Install figlet dependency and TypeScript types:
   ```bash
   npm install figlet
   npm install --save-dev @types/figlet
   ```

2. Create `src/cli/banner.ts` with:
   - Import figlet and picocolors (already a dependency)
   - Export `generateBanner(version: string): string` function
   - Use figlet.textSync('SCREENIE', { font: 'Big', horizontalLayout: 'fitted', width: 80 })
   - Format output as:
     - ASCII logo in cyan (using pc.cyan)
     - Version line: "v{version}" in dim
     - Tagline: "Capture responsive screenshots across 57 device viewports" in dim
     - Quick-start hint: "Run: screenie --help" in dim (satisfies INST-02 since we're skipping postinstall)
   - Ensure total width stays under 80 characters

Note: Use synchronous figlet.textSync(), not async version - simpler for CLI output.
  </action>
  <verify>
    - `npm ls figlet` shows figlet installed
    - `cat src/cli/banner.ts` shows generateBanner function
    - TypeScript compiles: `npx tsc --noEmit`
  </verify>
  <done>
    - figlet and @types/figlet in package.json
    - src/cli/banner.ts exports generateBanner function
    - No TypeScript errors
  </done>
</task>

<task type="auto">
  <name>Task 2: Integrate banner into version command</name>
  <files>
    src/cli/commands.ts
    src/cli/__tests__/e2e.test.ts
  </files>
  <action>
1. Modify `src/cli/commands.ts`:
   - Import generateBanner from './banner.js'
   - Replace `.version(__PKG_VERSION__)` with custom version handling
   - Add `.option('-v, --version', 'Display version with ASCII banner')`
   - In the action handler (or via Commander's hook), check if opts.version is true
   - If version flag set: call `console.log(generateBanner(__PKG_VERSION__))` and `process.exit(0)`

   Implementation approach (Commander pattern):
   ```typescript
   // Remove the .version() call entirely
   // Add as option instead
   .option('-v, --version', 'Display version with ASCII banner')

   // Add a hook that runs before any action
   .hook('preAction', (thisCommand) => {
     if (thisCommand.opts().version) {
       console.log(generateBanner(__PKG_VERSION__));
       process.exit(0);
     }
   });
   ```

2. Update e2e test in `src/cli/__tests__/e2e.test.ts`:
   - Modify the 'shows version with --version' test to expect ASCII art
   - Test should check: output contains 'SCREENIE', contains version pattern \d+\.\d+\.\d+
   - Add test for -v alias showing same output
  </action>
  <verify>
    - `npm run build && node ./dist/cli.js --version` shows ASCII banner
    - `npm run build && node ./dist/cli.js -v` shows identical output
    - `npm test` passes (including updated e2e tests)
  </verify>
  <done>
    - `screenie --version` displays ASCII banner with SCREENIE, version, tagline
    - `screenie -v` displays identical output
    - E2E tests verify banner output
  </done>
</task>

<task type="auto">
  <name>Task 3: Add banner unit tests</name>
  <files>
    src/cli/__tests__/banner.test.ts
  </files>
  <action>
1. Create `src/cli/__tests__/banner.test.ts`:
   - Import generateBanner from '../banner.js'
   - Import stripAnsi from 'strip-ansi' (already in devDependencies)
   - Import describe, it, expect from 'vitest'

2. Add test cases:
   - 'contains SCREENIE text in ASCII art': strip ANSI, check contains 'SCREENIE'
   - 'includes version number': generateBanner('2.2.0') contains '2.2.0'
   - 'includes tagline': contains 'responsive' or 'device viewports'
   - 'includes quick-start hint': contains 'screenie --help'
   - 'fits within 80 character width': split by \n, check each line.length <= 80
   - 'handles semantic version format': test with '1.0.0', '10.20.30' etc.

3. Run tests: `npm test`
  </action>
  <verify>
    - `npm test` passes including new banner.test.ts
    - `npm test -- --reporter=verbose` shows all banner tests passing
  </verify>
  <done>
    - src/cli/__tests__/banner.test.ts exists with 6+ test cases
    - All tests pass
    - Banner behavior fully covered by tests
  </done>
</task>

</tasks>

<verification>
After all tasks complete:

1. Build and test version output:
   ```bash
   npm run build
   node ./dist/cli.js --version
   node ./dist/cli.js -v
   ```
   Both should display identical ASCII banner with:
   - SCREENIE in stylized text
   - Version number (2.2.0)
   - Tagline about responsive screenshots
   - Quick-start hint

2. Verify width constraint:
   ```bash
   node ./dist/cli.js --version | while read line; do echo "${#line}"; done | sort -rn | head -1
   ```
   Should output <= 80

3. Run full test suite:
   ```bash
   npm test
   ```
   All 333+ tests should pass

4. Verify no regressions:
   ```bash
   node ./dist/cli.js --help
   ```
   Help should still work correctly
</verification>

<success_criteria>
1. `screenie --version` displays ASCII art banner with version 2.2.0
2. `screenie -v` displays identical output to --version
3. Banner contains SCREENIE ASCII art, version, tagline, and quick-start hint
4. All banner lines fit within 80 characters
5. All tests pass (existing + new banner tests)
6. No regressions in other CLI functionality
</success_criteria>

<output>
After completion, create `.planning/phases/19-ascii-art-branding/19-01-SUMMARY.md`
</output>
